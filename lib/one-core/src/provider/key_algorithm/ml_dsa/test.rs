use super::*;
use crate::model::key::PrivateKeyJwkMlweData;

#[test]
fn test_jwk_to_bytes() {
    let jwk = PublicKeyJwk::Mlwe(PublicKeyJwkMlweData {
        r#use: None,
        kid: None,
        alg: "CRYDI3".to_owned(),
        // Fake key just to prove the flow.
        x: "m7AE5UQdjLuCOnZHB1gCFfo2uvhM6W_4xFmpJK02r7s".to_owned(),
    });

    assert_eq!(
        vec![
            155, 176, 4, 229, 68, 29, 140, 187, 130, 58, 118, 71, 7, 88, 2, 21, 250, 54, 186, 248,
            76, 233, 111, 248, 196, 89, 169, 36, 173, 54, 175, 187,
        ],
        MlDsa.parse_jwk(&jwk).unwrap().public_key_as_raw()
    )
}

#[test]
fn test_jwk_to_bytes_fail_wrong_variant() {
    let jwk = PublicKeyJwk::Mlwe(PublicKeyJwkMlweData {
        r#use: None,
        kid: None,
        alg: "CRYDI5".to_owned(), // Incorrect variant
        // Fake key just to prove the flow.
        x: "m7AE5UQdjLuCOnZHB1gCFfo2uvhM6W_4xFmpJK02r7s".to_owned(),
    });

    assert!(MlDsa.parse_jwk(&jwk).is_err());
}

#[tokio::test]
async fn test_parse_jwk() {
    // given
    let ml_dsa = MlDsa;

    let private_jwk = PrivateKeyJwk::Mlwe(PrivateKeyJwkMlweData {
        r#use: None,
        kid: None,
        alg: "CRYDI3".to_owned(),
        x: "kD0mVs7WInjVJeO3Clajo0ANIFSGEcRDTuu-AICqN1peexYY6pGkoqjlHSEfUbPHjj4tHbMdnMFMFX92zx_Em9WC15ndjTiVhHVXJLtjiyLNl1-jEHHz9HMj-KR-1TWB-GLqHbQiHuO2k20LwYvmRYK7EjYjl8pGBf_jRZYMG_Jp4RuvTP9WEcC9mES_BF01rDhihrhQ5QKdurlkpuUdTfQvUWbPj5GxrtJFFICn3HC7RCqmZIoca06EwMv1pP2n1qRH33WTrAeLA_QVwbW127RcMyW5_-LFEFqJ3jS7JEeRPC-faXw6Y-e-noMTME3MfZ8Ip87gp_FXEGwQfuxpBetONv74skjVCPvDTL8pOX2H4Fj3Qx7pSP4m7zRh5iPy_JVcgJDxz7cZUtOTbdkQCc_Ix_yAvxX4VY8G0ute5a-1RD55MvdPAoAL__9V56UPUvzSyh3q3ml3p8Inc_IQHus-lxgzUYkqbwTwFS-1xog6qefbi_cRaSfvBXI8NCJCwZJkOa6u-ASKZBg_82ZTMNwR47NN1pv4nc0SmmWHQb3P9unaSkCLRG1mRovzhgSbulobgoGdaQqRQqOuuZUANFWRGIWEHsoD-NWY0TMVJpObwXmRFEFdQe9euFruxXjEC04HsS8kbtwLUx18xDBFqWQkB0frO2lApZHYXNh7zO087D_RKX4XbRk3UACmT7aKojmGW4bNktbFoC1g61usvAtXP8zxHPgMxYwesueiJROIgjy6_KDs-K_1Xb7TxESlshSvCCTvgNFDbpvQ_yzN_QiDqBQes_MvozIk9QFsoSJugMeTyzBP5yB8vFXYZFqqd3Ma8f9D2B4qBQj80W7XEhqxyf-62UJa4854lHV48ZvmhYnjgzRAYnZpIKi9OyfmZvP_U20Hq3uWS2-bO_HuXgZLzCk7umfUH3RZOwdA8JelasVGZqT9HZQFECTZB3J68QSdy-NMcNA1IyfSaWgOCiuXwGR0lqWv3f-uO0YzQE0Kdu9ODTXOrPgykMHOF92XJEqkszS9g0cuT4gKSIqjWjk6UF3cg1Miruci5ycTDH8zT1ntQoNOUau8KrJe3KkjjzveG1bddtU4kSKUHQDpMMcDsHOxSL6e66OI9AkzrJxTEFRpQlZ3-_tH43IQhmETDoHiPad-fbzQRnfOgJRpWh2ajXrsEcszyiqBvRkHt96giBfNZgCPbEk_7Q1XPPA8l5sretYZe7sY7qnUai9_6Md4R_rWejOLV3PF6b-61dpPj-gvsWwBEKd8KBDknMAtDnYYPUS0LwwCrF_QF_nQsSl36kWOzWsFTHKQU6GPUuFMQ_dpfh1mLIWmhwjD5VUsM-TGxXMOoKrCefDuIhGFEEF7kW0IzlpAJbxDHKxF_Lj5LA8HQEjMLoONOmJfVKMxlq5ynNsIIPSj2tcB9sINjxmih059GFivCjYNDi2fIO5b3oyJf4DgHws598e2ZZA--QiG8lTqVsNm1CcQFdyI0KZQEFlJXLmR-GIb3WF3zgxQrSNFM0IqFU9xHMyNEsR9ESOuic1g_TVyICxAllVHe2GY8elSiU7E1C1-QAUuBhzUCFHgy5PkgkOv1D4NLwjtK-DU7O5hAZ3eaxPCjXK6mqC0G1rys3AvM5rox0IdlONBVdmXeGpVfn3yrulL8Td1hykRvbroHEBncE1fKJO9J2BoE36_2j86N4_3lstaFqgX8NpHuHUYHO5bdk79gIhiS443YA6Ak-zUzBVhiRpEeh8NpEPAhu3dhIlCgJwo5zmgTAY2AR0WphlwuJ9GNdpNBYLQDUxYYMRCnBhuLu3WNDrIG4zQgAJl_rYuSisT3rLgnwaC5SjQLvQJauxdGD_XOnltebjM5X2dUnVb90kG9-1PmXP3pXgC6gmUTdBIMTjGLv9hlUxWJk9rLiSHQHNicSCSPnv-45OHFqA4d9acErhas8FK_uCA7mseVRPxc4Ay9C4GV8k_QMqYJhEq05j0_omvWNpGy5MywF6uRP6MYZMnPWyVFso9mP2uEr7oBCYasjnMouTFpKPwT0pvl_VLr1EFfMkB39GZc7lVla208-6phm9aaIrmpwf9UAe2VXYT8BPbvYStP8hhrRzpE606DtkH5bKzF49WVVm55gTMlMeP3n7OF7Vl5ArZyI6J7lCjwP2NEp1_XFFCyl795FY-s8NBJADGlnBZtrwRVYxVE8xXZIJ_eL9eL7FgZvOzdhQjuDOpJtwG1TkHC39MYjmwaTt6zOljHoQFlD69sV2i5kZ4GFcb3q8uts5g7FhhrWU1SjMMjtEnX1l4N45Mca3Bpa5MZxBqyntv1fgJ7hsPwegCKPAQWKckymo34uCFIbC2EcDiDFsMPk-22Kl9TqktGVhVdtkPlZRoybKxJqqcUUdhClkLKPUBOXmm3Xp_SMtOlq9Xjasa7TvDd0EIyqDWWrV4poiRw_easgJfvhCxSb7heOGgf1i2ryubRx4r_G8CWCGevA8rTF05J7sofGe_MzPHINaf11rP9jbbBY0BtHGpGl4jbwX9znqyd8B9dLgteXisPgYf7Gy8_aFFBezmBSgFaA5DTYwlHF3xGDuLCT0BNkv2QwQ1deQsbzXuD-w".to_string(),
        d: "kD0mVs7WInjVJeO3Clajo0ANIFSGEcRDTuu-AICqN1ooAXBpfuIwsxaAxLcHZ9JEeGweDQPLRQQl4k3jTUrembkv606FiWOglhCRdimVFUtSCfNSLNEG8B3CmXhpatYAE2eBAYU4UiAQWAF4hIYjIhRhg0dWUmVXCDJ4dEVhUoNYBDMkeDMQI1IDVGV0BkFCRGAIFDcigyVIU2YGAGY0QoR0BkhVMgdwJlUDA0YCMQCENYESBREgdBMRExJYWHaFEYUARwBkQ0d3gxVoFoZzEkZTUQZ1BTE4UyNwBWSIFyNRdRZzZVdANjMmAhNDRSA1aGcWdThSQlRyh1BiKHOFcQhCdnAARoUhKEEndlZGFzF2hghxGINTBwVjVzZEMgiFImcUgVR2FDhTARCHOIdIIUCEQjIhcIYVZwAHd3EXRxBIY0NlMISCBAWGViRGSBcwIQgxNTQkEDGIEQgmQDFQZhAFNRRYdUWHABZhYwZ0GBGBhxECUkVEJ1MzVyMkIDd1AzBQEBVlUkIlcyMHhzRkRSVIM1GIB0BWGCMHF2KDYVdUcIQ0aFIlFnJYQ1cleDh1aAFAUyQQh2cXgFFQCDSEIoZYIFg3RWV1FkNCNmViUyIBdXBXRkQWNXIYJhRohzSIQYEUKGJBdEgHZ0N3glNyCGRFIiNnVSAFMlNSdAFARkUwREZzF0MVEkBXFgEHQwFXIoZQEjEEWDE2cAGHEogWdxaFAiBIIINQcyckQFYjZHRSaAQAEFJkYxdVcoRlSHNDcmcDSCYlAXYAaCd1RlEINWYFdmhzd3UVOIWGY1MAhFVCU1dxFIhRRnRkIhZ0UgBAcmYIaIYlhDaHMCZVCFFRElUYcoaEKHVgQxdGYSgHYCIwdSCIUidoQjAXMoMgcCBnY1hXR4Z3ATVwGGIzJnSIV4NyhTYURBRYUwdGYTERMFY2GIR4IzdGESGDcTQWaCNiFIdhFUYDQlhRV4d3NIRXZGJoFiaGMydUgHQIhhdgcncWIHYXIHdnMGWAE1RHBiCIdnYFYwRYRVMWaDcDF2gGSIVCAod0VBBYBAcBNCITF1EDJhUWABR2UBREU3OGN2J0VViBgoZGVQJIaAhHgGcAYShyAVB1gAMBOIMghmCEVQhxMTJyg1eFdxeDBohIVAUGMmMhBwQohVB4ETMkJEVQJ1eANmQUFiAXBIAVQoRVFARTNldkNBSCOCYmIXYxITdCcGEVJWBgZHUQVCSGBWViEAVHAhNTYTUUMxhgGDIncQR4N0ITgQEyZ3iEgxeHQDQ2IBIlh1djWBJFAXCCRFYERGZIJICGKIYBcxIWYhQlg0cxJwJQGDBRAWVFJgGDQ0ISJ4FhhGEHUUBTh4RDQAVIhACDJiJ1NUZHByVxMmc4ZgQRZQU3NAFiKHgoNYMCETRmcQBFSAVDA2gnCARUZzhUJWADASZnEFCFVjAgUxYRJAMVgieDUWMoeAZwNwaDAXY1A2MXSFEEUIcYEmNUhySGMFhUBTY4OERXeDgENHFGhCSEZlBmJYNiRGIzAGhSV4Z0g4JDQRdHIYgFCBhlFAZ4AFdSiHcHdnMic4VEE3IjZnYyISeAVwUjgDBGBCQIIFOGJzU4MUJ4OAdyVXByJ0IBJQZIYlQ0KIAghgRHc4YUMyZldnIWWHIwA4dEV1cWeHWDhlVmYxB0N1ImJgQHEFVIQFJHQxJwYTZ1VjNkRiMhCBhDVlUQg0AydVZEBDBQERIwECRgFEVyeBRBMkBHcxVAh0hIUWUAIYJQU3czd0QEhgRQQRNFIXZyUIMTEzUwIjRWcRdUMTMSdBAjQGCHVIciF0hIA1hkYmB4d4cxdDdHNCAGUzYjVyN4JHJHZ1hFSDA3RYBBMUIIWCMDFwVzRigViFZTMmdFZjYkQjcYFRU4ERI4YxYxhGZoAGdzZhdDJ4UXZ4gDRwdlNVVkIREDQxSEOBUnaIMWdiUDcDEERYRhYjZmdnFUhSNEEwWEMYV1hFBwIyZhFQNmWANkUVJRB4QAE1byaWK7aym26qDCch-iCDoh7eT3CJvkw_VTQ5XUpC-DYYvHPHbfvPZvLJ_h7Gq2v8E9BGsRC2knnXLt5DfzVTVBLqGs90CA78zear3NwvigOfndKFlAlemU_4QZLTZ8rURFgfJnxihvnFz74RgZZR7ayWbyPgNd2X5chu1AIJuFbl4Pj2q4oaZqF3i1LImxcC1vrzKLZyae23TitnIsTG_-Poe-CJflFzrDzCQuZHqe4WQ8wjNJjMopdV76TbIpLOOEk_pZn7Y_i3A8W-MOQBmTZDRUxjDBBmVgX90RDU1yjNc9cSigwN8u0OLg4jm4a3SxcO5O7hT7BiBohCCAl-Yr4WwPgqELpXPXzqL8vdL6-7ZWgeh6mSPbiB9Ln-6J1ntEd7DaaegFxOJsyhu7qiAcessUW1qPTY4TcA5PDcALMCrwFwf75X3aHi_VY8P7-T3NZ3At0nrehn7AD4AXTc7kYqXgsy-aCF3MHMtwzVFHd8WcRA2a7hJTPcTtttgzltGV0gqz3A4JTwC0ThPBwN1HMv5Exoa5Gn4KDOVSTRqF0MpykkJw2NR6J4N4DFHkCyrwwoBVBsEuJyVUOzORLXJMWuMJO1fGYfRP5lRtcNjSl3fsLBy9HzXdh4QRqgkiYT3wq-zl8nKBOyoBNnhuaXVWkAQBUtv46o9tK68VF6P-qwP4aNRi1hd3WtWj8Y8yw8qj_UlDuWWZY6uJcouSoBCIkcSgf9fFxTpEEIwYxBZHMzG2bxUfpEMOxhec9FzEXDfLM1Bdp3o9BkAxKMY62OYr1dK6RX8hwCdS-kRqqzcLbQK-UwCY-rBBdL_uaIIlKCvwkBP1GFQUCjhNPeCr3SRdyj278BEowVKirvlCKGzazOKWzP1M_MUfnD04GMbF2Mvb5zcUYN4ihcU7osOscv0J5-ZnOiy1G9SWfqPfwo1y8EyHdVBUAjr_6lDNPJRSQJUTJpgGcnwgHMN6ld-80wktxBJ1gW9w2aB1WsRYYG6Vl-bkQGdWf-waFv2Fg7x5grgnqlGe0C4ai7M2xTfDn4pMX-ybFLUxdwk-oN5aAtUuNyrjIZnZLrWmFylvUOQ2y3A-xf0CakbfhS6kMQb1lKcV_deeuD0B9rAo62OURJU9i7DIt8Gen7kk-y6ZPX3F4c4_eXUY46x36WyUNtPP8a3XUyDSCNWwAlID-LVuS8IyPv0o3dOTg-xxXdZFRL5C2TsAynQtzlPpaxDFIS7pH-Y9Lu9-HvXnUqq3vachR-gqr6iN_O_-4JoXvnCm4JJiaV3bco6-9bgMVX6Uz6xWZwBJv9kRdCKXySsbFpW82Dk12rUYHK9hJi_SvTvctAT_--_Y2Xd0qbJjTYC5zW5QXTXc2IEDz1Y3T2TqIhfHdeFsOsi8bbgNQjPpoc6mOC6ofpc3sn6OaGbSKgbPvvJs9rq0b08L4yRyVqKcoDPdmsFxR_bsu9XNpbtHZsq1ryXyMXk6-xOC8yfQgqKRtQIA9IYrE2DwtghvzGXnTWRt2selkMqJr9RJfb1Kdiv6bYtrIUfwklO9QNBFq5wJVqm9X_bVm4HG8uvQWJJevRmPnBiLa9kl4i0Y7bU3wg2xPNF33ksqbVSfqZmKs6sgLzuq5hRT11DmInQWGlq2HE4KSPdqRLqWWqOBMdXrgMoOI2-mjKn-FW_YquytJrg2XmLtmg8u7l__R-_ebfS9f0zo-bWvMmSXBmL7LnYYZQwVdXWzOXrmueeVCe1MnC8GgWtf1UCPCJNoDDFu4y7GqDiFK9msxUZwJMAWmy6Tu0d7SP3w5xXudmVN45jTfl35IpVR-bTrGHPrmtHxeCaTBp132TLnFsSOnUqzBdzRpd_Y1sPxACtRJ8CZf75I8dgngrPjRBHMjsC0WLYFq5UZVwACddedKpLiRQbjsKmiEheYA5PwrhF4MMGpWg23u4O93-VHTtJyxOCu7czHUkfOorHL1l4frnJop4VT7XqbORZD4Rv8Yu_90iinkRBtmc4GC3uwMIOzAjcsLIiGjJlzAlwc0Mio9lIr1u_h7XXKqk_SjnhJSATSgacJ2WBsloNtwtwc7nn4o928tJ4MBRSZppi2EbifAJCf7pWmZT9LqnXrgjuAClR9CMTnKvleAYJwfwx-1iPagHpO29I-LaUoWugOjUmzbXXIzSjjP4c5LqhHXJNBDxTEwnxHeYKWHMsiwNZjW2h06e4wJtey7KRve6FSfOI9oqfXG896JQWTrikCfKwmfEWyNvwyWtEfhBwMZvjaCM2Nr1sHqLplG2BY1RcXgngdnnIuWulRZtXjH8aS7MCOlhsq-6OWoQvkxwgv8VcpO44kHC5UwtdMYcxKHDztV37HztFlqWvhctgon6F-1T93bNpnzoCPRJUls-k9kZ2wXf16n6XuskSlWyuzO5w16OYXkJX4NMxCAj30x4SpQbLkFZKu_2RAkSAZ8wtFFNCfIv8veZK8GBJWQAh1W3bM0pmIFNQAxAkTS8aryDkpXXqjWP16paCFCY8kt7AjxsamKlgTVTszlrgdpTV4VjUgFQJH_gGbqB7WZrZoiOqkBlRiljxsIT8_4-17hRlZcmit0ECphDwsb9M_xvSe_6e9wir5976E0N-nLi7_8DhqoqjnO6KuYT44Kn674ONo_rqJz0vPbM0oLUQKncwDbJvG_W2KJOPaJ_MylnhJoMBvIEP7KUBAruPXA1RXYIBLfTyvhw-VOO0iDdI0xwzNpVWIe0LEw5bT4I6OSWPtFLLjZX272INjw8C4mTqsM1UknFImd6L3TmHQI7GwvuUNpTi79v2JSbXqrjD2spc2ad85jcNv5MyLX55iBa3P7jtZ9hLNRp7HuZFwQqlgkc6eoG6mfGzHsqVenfIDT1sjmpmuNahlOQMrY8RXhRfoA3PgwUKi9o6jy3Ys2irPB9mNSmPUoeTMBy2AUFc0evPQTRMNeS0JbcVqbSqD1JZrUfhdoNhxxgjQ1QxmHSh9IQ2AcjSI-VkzueOI3Rg92Rpjd1gb7ShUlR06-_b4EQgYjw40wHA0eivfL7PUF--dHrBYH9EyXh3mxVEnc525FuXwk-sI3GfcU8ug95A0-LX1z7meA_FyH_tRn6OB_T0fx5EZyKkGCvdROznqgcUSyPKtSLqNYQ9nzk1pqXusN4_JSdSmRbs4bo2seiRMWaPdO7zram0865ecIv2qbOU61JnY_Iz2QEpzTChLWNNEDxSRUtByjIGH4wRL8_FmDhyfPrwnGN9Mo2_bMYF3yqwwetyAxWolWLITIGfKsEmIzFjmhvJgXk1XM2rNIC1Y22MFIykOmlprfPT2WWPX1Eim4lrjQHpkwrRxwQ".into(),
    });

    // when
    let generated_key = ml_dsa.parse_private_jwk(private_jwk).unwrap();

    // then
    assert_eq!(
        vec![
            144, 61, 38, 86, 206, 214, 34, 120, 213, 37, 227, 183, 10, 86, 163, 163, 64, 13, 32,
            84, 134, 17, 196, 67, 78, 235, 190, 0, 128, 170, 55, 90, 94, 123, 22, 24, 234, 145,
            164, 162, 168, 229, 29, 33, 31, 81, 179, 199, 142, 62, 45, 29, 179, 29, 156, 193, 76,
            21, 127, 118, 207, 31, 196, 155, 213, 130, 215, 153, 221, 141, 56, 149, 132, 117, 87,
            36, 187, 99, 139, 34, 205, 151, 95, 163, 16, 113, 243, 244, 115, 35, 248, 164, 126,
            213, 53, 129, 248, 98, 234, 29, 180, 34, 30, 227, 182, 147, 109, 11, 193, 139, 230, 69,
            130, 187, 18, 54, 35, 151, 202, 70, 5, 255, 227, 69, 150, 12, 27, 242, 105, 225, 27,
            175, 76, 255, 86, 17, 192, 189, 152, 68, 191, 4, 93, 53, 172, 56, 98, 134, 184, 80,
            229, 2, 157, 186, 185, 100, 166, 229, 29, 77, 244, 47, 81, 102, 207, 143, 145, 177,
            174, 210, 69, 20, 128, 167, 220, 112, 187, 68, 42, 166, 100, 138, 28, 107, 78, 132,
            192, 203, 245, 164, 253, 167, 214, 164, 71, 223, 117, 147, 172, 7, 139, 3, 244, 21,
            193, 181, 181, 219, 180, 92, 51, 37, 185, 255, 226, 197, 16, 90, 137, 222, 52, 187, 36,
            71, 145, 60, 47, 159, 105, 124, 58, 99, 231, 190, 158, 131, 19, 48, 77, 204, 125, 159,
            8, 167, 206, 224, 167, 241, 87, 16, 108, 16, 126, 236, 105, 5, 235, 78, 54, 254, 248,
            178, 72, 213, 8, 251, 195, 76, 191, 41, 57, 125, 135, 224, 88, 247, 67, 30, 233, 72,
            254, 38, 239, 52, 97, 230, 35, 242, 252, 149, 92, 128, 144, 241, 207, 183, 25, 82, 211,
            147, 109, 217, 16, 9, 207, 200, 199, 252, 128, 191, 21, 248, 85, 143, 6, 210, 235, 94,
            229, 175, 181, 68, 62, 121, 50, 247, 79, 2, 128, 11, 255, 255, 85, 231, 165, 15, 82,
            252, 210, 202, 29, 234, 222, 105, 119, 167, 194, 39, 115, 242, 16, 30, 235, 62, 151,
            24, 51, 81, 137, 42, 111, 4, 240, 21, 47, 181, 198, 136, 58, 169, 231, 219, 139, 247,
            17, 105, 39, 239, 5, 114, 60, 52, 34, 66, 193, 146, 100, 57, 174, 174, 248, 4, 138,
            100, 24, 63, 243, 102, 83, 48, 220, 17, 227, 179, 77, 214, 155, 248, 157, 205, 18, 154,
            101, 135, 65, 189, 207, 246, 233, 218, 74, 64, 139, 68, 109, 102, 70, 139, 243, 134, 4,
            155, 186, 90, 27, 130, 129, 157, 105, 10, 145, 66, 163, 174, 185, 149, 0, 52, 85, 145,
            24, 133, 132, 30, 202, 3, 248, 213, 152, 209, 51, 21, 38, 147, 155, 193, 121, 145, 20,
            65, 93, 65, 239, 94, 184, 90, 238, 197, 120, 196, 11, 78, 7, 177, 47, 36, 110, 220, 11,
            83, 29, 124, 196, 48, 69, 169, 100, 36, 7, 71, 235, 59, 105, 64, 165, 145, 216, 92,
            216, 123, 204, 237, 60, 236, 63, 209, 41, 126, 23, 109, 25, 55, 80, 0, 166, 79, 182,
            138, 162, 57, 134, 91, 134, 205, 146, 214, 197, 160, 45, 96, 235, 91, 172, 188, 11, 87,
            63, 204, 241, 28, 248, 12, 197, 140, 30, 178, 231, 162, 37, 19, 136, 130, 60, 186, 252,
            160, 236, 248, 175, 245, 93, 190, 211, 196, 68, 165, 178, 20, 175, 8, 36, 239, 128,
            209, 67, 110, 155, 208, 255, 44, 205, 253, 8, 131, 168, 20, 30, 179, 243, 47, 163, 50,
            36, 245, 1, 108, 161, 34, 110, 128, 199, 147, 203, 48, 79, 231, 32, 124, 188, 85, 216,
            100, 90, 170, 119, 115, 26, 241, 255, 67, 216, 30, 42, 5, 8, 252, 209, 110, 215, 18,
            26, 177, 201, 255, 186, 217, 66, 90, 227, 206, 120, 148, 117, 120, 241, 155, 230, 133,
            137, 227, 131, 52, 64, 98, 118, 105, 32, 168, 189, 59, 39, 230, 102, 243, 255, 83, 109,
            7, 171, 123, 150, 75, 111, 155, 59, 241, 238, 94, 6, 75, 204, 41, 59, 186, 103, 212,
            31, 116, 89, 59, 7, 64, 240, 151, 165, 106, 197, 70, 102, 164, 253, 29, 148, 5, 16, 36,
            217, 7, 114, 122, 241, 4, 157, 203, 227, 76, 112, 208, 53, 35, 39, 210, 105, 104, 14,
            10, 43, 151, 192, 100, 116, 150, 165, 175, 221, 255, 174, 59, 70, 51, 64, 77, 10, 118,
            239, 78, 13, 53, 206, 172, 248, 50, 144, 193, 206, 23, 221, 151, 36, 74, 164, 179, 52,
            189, 131, 71, 46, 79, 136, 10, 72, 138, 163, 90, 57, 58, 80, 93, 220, 131, 83, 34, 174,
            231, 34, 231, 39, 19, 12, 127, 51, 79, 89, 237, 66, 131, 78, 81, 171, 188, 42, 178, 94,
            220, 169, 35, 143, 59, 222, 27, 86, 221, 118, 213, 56, 145, 34, 148, 29, 0, 233, 48,
            199, 3, 176, 115, 177, 72, 190, 158, 235, 163, 136, 244, 9, 51, 172, 156, 83, 16, 84,
            105, 66, 86, 119, 251, 251, 71, 227, 114, 16, 134, 97, 19, 14, 129, 226, 61, 167, 126,
            125, 188, 208, 70, 119, 206, 128, 148, 105, 90, 29, 154, 141, 122, 236, 17, 203, 51,
            202, 42, 129, 189, 25, 7, 183, 222, 160, 136, 23, 205, 102, 0, 143, 108, 73, 63, 237,
            13, 87, 60, 240, 60, 151, 155, 43, 122, 214, 25, 123, 187, 24, 238, 169, 212, 106, 47,
            127, 232, 199, 120, 71, 250, 214, 122, 51, 139, 87, 115, 197, 233, 191, 186, 213, 218,
            79, 143, 232, 47, 177, 108, 1, 16, 167, 124, 40, 16, 228, 156, 192, 45, 14, 118, 24,
            61, 68, 180, 47, 12, 2, 172, 95, 208, 23, 249, 208, 177, 41, 119, 234, 69, 142, 205,
            107, 5, 76, 114, 144, 83, 161, 143, 82, 225, 76, 67, 247, 105, 126, 29, 102, 44, 133,
            166, 135, 8, 195, 229, 85, 44, 51, 228, 198, 197, 115, 14, 160, 170, 194, 121, 240,
            238, 34, 17, 133, 16, 65, 123, 145, 109, 8, 206, 90, 64, 37, 188, 67, 28, 172, 69, 252,
            184, 249, 44, 15, 7, 64, 72, 204, 46, 131, 141, 58, 98, 95, 84, 163, 49, 150, 174, 114,
            156, 219, 8, 32, 244, 163, 218, 215, 1, 246, 194, 13, 143, 25, 162, 135, 78, 125, 24,
            88, 175, 10, 54, 13, 14, 45, 159, 32, 238, 91, 222, 140, 137, 127, 128, 224, 31, 11,
            57, 247, 199, 182, 101, 144, 62, 249, 8, 134, 242, 84, 234, 86, 195, 102, 212, 39, 16,
            21, 220, 136, 208, 166, 80, 16, 89, 73, 92, 185, 145, 248, 98, 27, 221, 97, 119, 206,
            12, 80, 173, 35, 69, 51, 66, 42, 21, 79, 113, 28, 204, 141, 18, 196, 125, 17, 35, 174,
            137, 205, 96, 253, 53, 114, 32, 44, 64, 150, 85, 71, 123, 97, 152, 241, 233, 82, 137,
            78, 196, 212, 45, 126, 64, 5, 46, 6, 28, 212, 8, 81, 224, 203, 147, 228, 130, 67, 175,
            212, 62, 13, 47, 8, 237, 43, 224, 212, 236, 238, 97, 1, 157, 222, 107, 19, 194, 141,
            114, 186, 154, 160, 180, 27, 90, 242, 179, 112, 47, 51, 154, 232, 199, 66, 29, 148,
            227, 65, 85, 217, 151, 120, 106, 85, 126, 125, 242, 174, 233, 75, 241, 55, 117, 135,
            41, 17, 189, 186, 232, 28, 64, 103, 112, 77, 95, 40, 147, 189, 39, 96, 104, 19, 126,
            191, 218, 63, 58, 55, 143, 247, 150, 203, 90, 22, 168, 23, 240, 218, 71, 184, 117, 24,
            28, 238, 91, 118, 78, 253, 128, 136, 98, 75, 142, 55, 96, 14, 128, 147, 236, 212, 204,
            21, 97, 137, 26, 68, 122, 31, 13, 164, 67, 192, 134, 237, 221, 132, 137, 66, 128, 156,
            40, 231, 57, 160, 76, 6, 54, 1, 29, 22, 166, 25, 112, 184, 159, 70, 53, 218, 77, 5,
            130, 208, 13, 76, 88, 96, 196, 66, 156, 24, 110, 46, 237, 214, 52, 58, 200, 27, 140,
            208, 128, 2, 101, 254, 182, 46, 74, 43, 19, 222, 178, 224, 159, 6, 130, 229, 40, 208,
            46, 244, 9, 106, 236, 93, 24, 63, 215, 58, 121, 109, 121, 184, 204, 229, 125, 157, 82,
            117, 91, 247, 73, 6, 247, 237, 79, 153, 115, 247, 165, 120, 2, 234, 9, 148, 77, 208,
            72, 49, 56, 198, 46, 255, 97, 149, 76, 86, 38, 79, 107, 46, 36, 135, 64, 115, 98, 113,
            32, 146, 62, 123, 254, 227, 147, 135, 22, 160, 56, 119, 214, 156, 18, 184, 90, 179,
            193, 74, 254, 224, 128, 238, 107, 30, 85, 19, 241, 115, 128, 50, 244, 46, 6, 87, 201,
            63, 64, 202, 152, 38, 17, 42, 211, 152, 244, 254, 137, 175, 88, 218, 70, 203, 147, 50,
            192, 94, 174, 68, 254, 140, 97, 147, 39, 61, 108, 149, 22, 202, 61, 152, 253, 174, 18,
            190, 232, 4, 38, 26, 178, 57, 204, 162, 228, 197, 164, 163, 240, 79, 74, 111, 151, 245,
            75, 175, 81, 5, 124, 201, 1, 223, 209, 153, 115, 185, 85, 149, 173, 180, 243, 238, 169,
            134, 111, 90, 104, 138, 230, 167, 7, 253, 80, 7, 182, 85, 118, 19, 240, 19, 219, 189,
            132, 173, 63, 200, 97, 173, 28, 233, 19, 173, 58, 14, 217, 7, 229, 178, 179, 23, 143,
            86, 85, 89, 185, 230, 4, 204, 148, 199, 143, 222, 126, 206, 23, 181, 101, 228, 10, 217,
            200, 142, 137, 238, 80, 163, 192, 253, 141, 18, 157, 127, 92, 81, 66, 202, 94, 253,
            228, 86, 62, 179, 195, 65, 36, 0, 198, 150, 112, 89, 182, 188, 17, 85, 140, 85, 19,
            204, 87, 100, 130, 127, 120, 191, 94, 47, 177, 96, 102, 243, 179, 118, 20, 35, 184, 51,
            169, 38, 220, 6, 213, 57, 7, 11, 127, 76, 98, 57, 176, 105, 59, 122, 204, 233, 99, 30,
            132, 5, 148, 62, 189, 177, 93, 162, 230, 70, 120, 24, 87, 27, 222, 175, 46, 182, 206,
            96, 236, 88, 97, 173, 101, 53, 74, 51, 12, 142, 209, 39, 95, 89, 120, 55, 142, 76, 113,
            173, 193, 165, 174, 76, 103, 16, 106, 202, 123, 111, 213, 248, 9, 238, 27, 15, 193,
            232, 2, 40, 240, 16, 88, 167, 36, 202, 106, 55, 226, 224, 133, 33, 176, 182, 17, 192,
            226, 12, 91, 12, 62, 79, 182, 216, 169, 125, 78, 169, 45, 25, 88, 85, 118, 217, 15,
            149, 148, 104, 201, 178, 177, 38, 170, 156, 81, 71, 97, 10, 89, 11, 40, 245, 1, 57,
            121, 166, 221, 122, 127, 72, 203, 78, 150, 175, 87, 141, 171, 26, 237, 59, 195, 119,
            65, 8, 202, 160, 214, 90, 181, 120, 166, 136, 145, 195, 247, 154, 178, 2, 95, 190, 16,
            177, 73, 190, 225, 120, 225, 160, 127, 88, 182, 175, 43, 155, 71, 30, 43, 252, 111, 2,
            88, 33, 158, 188, 15, 43, 76, 93, 57, 39, 187, 40, 124, 103, 191, 51, 51, 199, 32, 214,
            159, 215, 90, 207, 246, 54, 219, 5, 141, 1, 180, 113, 169, 26, 94, 35, 111, 5, 253,
            206, 122, 178, 119, 192, 125, 116, 184, 45, 121, 120, 172, 62, 6, 31, 236, 108, 188,
            253, 161, 69, 5, 236, 230, 5, 40, 5, 104, 14, 67, 77, 140, 37, 28, 93, 241, 24, 59,
            139, 9, 61, 1, 54, 75, 246, 67, 4, 53, 117, 228, 44, 111, 53, 238, 15, 236
        ],
        generated_key.public
    );
    assert_eq!(
        vec![
            144, 61, 38, 86, 206, 214, 34, 120, 213, 37, 227, 183, 10, 86, 163, 163, 64, 13, 32,
            84, 134, 17, 196, 67, 78, 235, 190, 0, 128, 170, 55, 90, 40, 1, 112, 105, 126, 226, 48,
            179, 22, 128, 196, 183, 7, 103, 210, 68, 120, 108, 30, 13, 3, 203, 69, 4, 37, 226, 77,
            227, 77, 74, 222, 153, 185, 47, 235, 78, 133, 137, 99, 160, 150, 16, 145, 118, 41, 149,
            21, 75, 82, 9, 243, 82, 44, 209, 6, 240, 29, 194, 153, 120, 105, 106, 214, 0, 19, 103,
            129, 1, 133, 56, 82, 32, 16, 88, 1, 120, 132, 134, 35, 34, 20, 97, 131, 71, 86, 82,
            101, 87, 8, 50, 120, 116, 69, 97, 82, 131, 88, 4, 51, 36, 120, 51, 16, 35, 82, 3, 84,
            101, 116, 6, 65, 66, 68, 96, 8, 20, 55, 34, 131, 37, 72, 83, 102, 6, 0, 102, 52, 66,
            132, 116, 6, 72, 85, 50, 7, 112, 38, 85, 3, 3, 70, 2, 49, 0, 132, 53, 129, 18, 5, 17,
            32, 116, 19, 17, 19, 18, 88, 88, 118, 133, 17, 133, 0, 71, 0, 100, 67, 71, 119, 131,
            21, 104, 22, 134, 115, 18, 70, 83, 81, 6, 117, 5, 49, 56, 83, 35, 112, 5, 100, 136, 23,
            35, 81, 117, 22, 115, 101, 87, 64, 54, 51, 38, 2, 19, 67, 69, 32, 53, 104, 103, 22,
            117, 56, 82, 66, 84, 114, 135, 80, 98, 40, 115, 133, 113, 8, 66, 118, 112, 0, 70, 133,
            33, 40, 65, 39, 118, 86, 70, 23, 49, 118, 134, 8, 113, 24, 131, 83, 7, 5, 99, 87, 54,
            68, 50, 8, 133, 34, 103, 20, 129, 84, 118, 20, 56, 83, 1, 16, 135, 56, 135, 72, 33, 64,
            132, 66, 50, 33, 112, 134, 21, 103, 0, 7, 119, 113, 23, 71, 16, 72, 99, 67, 101, 48,
            132, 130, 4, 5, 134, 86, 36, 70, 72, 23, 48, 33, 8, 49, 53, 52, 36, 16, 49, 136, 17, 8,
            38, 64, 49, 80, 102, 16, 5, 53, 20, 88, 117, 69, 135, 0, 22, 97, 99, 6, 116, 24, 17,
            129, 135, 17, 2, 82, 69, 68, 39, 83, 51, 87, 35, 36, 32, 55, 117, 3, 48, 80, 16, 21,
            101, 82, 66, 37, 115, 35, 7, 135, 52, 100, 69, 37, 72, 51, 81, 136, 7, 64, 86, 24, 35,
            7, 23, 98, 131, 97, 87, 84, 112, 132, 52, 104, 82, 37, 22, 114, 88, 67, 87, 37, 120,
            56, 117, 104, 1, 64, 83, 36, 16, 135, 103, 23, 128, 81, 80, 8, 52, 132, 34, 134, 88,
            32, 88, 55, 69, 101, 117, 22, 67, 66, 54, 101, 98, 83, 34, 1, 117, 112, 87, 70, 68, 22,
            53, 114, 24, 38, 20, 104, 135, 52, 136, 65, 129, 20, 40, 98, 65, 116, 72, 7, 103, 67,
            119, 130, 83, 114, 8, 100, 69, 34, 35, 103, 85, 32, 5, 50, 83, 82, 116, 1, 64, 70, 69,
            48, 68, 70, 115, 23, 67, 21, 18, 64, 87, 22, 1, 7, 67, 1, 87, 34, 134, 80, 18, 49, 4,
            88, 49, 54, 112, 1, 135, 18, 136, 22, 119, 22, 133, 2, 32, 72, 32, 131, 80, 115, 39,
            36, 64, 86, 35, 100, 116, 82, 104, 4, 0, 16, 82, 100, 99, 23, 85, 114, 132, 101, 72,
            115, 67, 114, 103, 3, 72, 38, 37, 1, 118, 0, 104, 39, 117, 70, 81, 8, 53, 102, 5, 118,
            104, 115, 119, 117, 21, 56, 133, 134, 99, 83, 0, 132, 85, 66, 83, 87, 113, 20, 136, 81,
            70, 116, 100, 34, 22, 116, 82, 0, 64, 114, 102, 8, 104, 134, 37, 132, 54, 135, 48, 38,
            85, 8, 81, 81, 18, 85, 24, 114, 134, 132, 40, 117, 96, 67, 23, 70, 97, 40, 7, 96, 34,
            48, 117, 32, 136, 82, 39, 104, 66, 48, 23, 50, 131, 32, 112, 32, 103, 99, 88, 87, 71,
            134, 119, 1, 53, 112, 24, 98, 51, 38, 116, 136, 87, 131, 114, 133, 54, 20, 68, 20, 88,
            83, 7, 70, 97, 49, 17, 48, 86, 54, 24, 132, 120, 35, 55, 70, 17, 33, 131, 113, 52, 22,
            104, 35, 98, 20, 135, 97, 21, 70, 3, 66, 88, 81, 87, 135, 119, 52, 132, 87, 100, 98,
            104, 22, 38, 134, 51, 39, 84, 128, 116, 8, 134, 23, 96, 114, 119, 22, 32, 118, 23, 32,
            119, 103, 48, 101, 128, 19, 84, 71, 6, 32, 136, 118, 118, 5, 99, 4, 88, 69, 83, 22,
            104, 55, 3, 23, 104, 6, 72, 133, 66, 2, 135, 116, 84, 16, 88, 4, 7, 1, 52, 34, 19, 23,
            81, 3, 38, 21, 22, 0, 20, 118, 80, 20, 68, 83, 115, 134, 55, 98, 116, 85, 88, 129, 130,
            134, 70, 85, 2, 72, 104, 8, 71, 128, 103, 0, 97, 40, 114, 1, 80, 117, 128, 3, 1, 56,
            131, 32, 134, 96, 132, 85, 8, 113, 49, 50, 114, 131, 87, 133, 119, 23, 131, 6, 136, 72,
            84, 5, 6, 50, 99, 33, 7, 4, 40, 133, 80, 120, 17, 51, 36, 36, 69, 80, 39, 87, 128, 54,
            100, 20, 22, 32, 23, 4, 128, 21, 66, 132, 85, 20, 4, 83, 54, 87, 100, 52, 20, 130, 56,
            38, 38, 33, 118, 49, 33, 55, 66, 112, 97, 21, 37, 96, 96, 100, 117, 16, 84, 36, 134, 5,
            101, 98, 16, 5, 71, 2, 19, 83, 97, 53, 20, 51, 24, 96, 24, 50, 39, 113, 4, 120, 55, 66,
            19, 129, 1, 50, 103, 120, 132, 131, 23, 135, 64, 52, 54, 32, 18, 37, 135, 87, 99, 88,
            18, 69, 1, 112, 130, 68, 86, 4, 68, 102, 72, 36, 128, 134, 40, 134, 1, 115, 18, 22, 98,
            20, 37, 131, 71, 49, 39, 2, 80, 24, 48, 81, 1, 101, 69, 38, 1, 131, 67, 66, 18, 39,
            129, 97, 132, 97, 7, 81, 64, 83, 135, 132, 67, 64, 5, 72, 132, 0, 131, 38, 34, 117, 53,
            70, 71, 7, 37, 113, 50, 103, 56, 102, 4, 17, 101, 5, 55, 52, 1, 98, 40, 120, 40, 53,
            131, 2, 17, 52, 102, 113, 0, 69, 72, 5, 67, 3, 104, 39, 8, 4, 84, 103, 56, 84, 37, 96,
            3, 1, 38, 103, 16, 80, 133, 86, 48, 32, 83, 22, 17, 36, 3, 21, 130, 39, 131, 81, 99,
            40, 120, 6, 112, 55, 6, 131, 1, 118, 53, 3, 99, 23, 72, 81, 4, 80, 135, 24, 18, 99, 84,
            135, 36, 134, 48, 88, 84, 5, 54, 56, 56, 68, 87, 120, 56, 4, 52, 113, 70, 132, 36, 132,
            102, 80, 102, 37, 131, 98, 68, 98, 51, 0, 104, 82, 87, 134, 116, 131, 130, 67, 65, 23,
            71, 33, 136, 5, 8, 24, 101, 20, 6, 120, 0, 87, 82, 136, 119, 7, 118, 115, 34, 115, 133,
            68, 19, 114, 35, 102, 118, 50, 33, 39, 128, 87, 5, 35, 128, 48, 70, 4, 36, 8, 32, 83,
            134, 39, 53, 56, 49, 66, 120, 56, 7, 114, 85, 112, 114, 39, 66, 1, 37, 6, 72, 98, 84,
            52, 40, 128, 32, 134, 4, 71, 115, 134, 20, 51, 38, 101, 118, 114, 22, 88, 114, 48, 3,
            135, 68, 87, 87, 22, 120, 117, 131, 134, 85, 102, 99, 16, 116, 55, 82, 38, 38, 4, 7,
            16, 85, 72, 64, 82, 71, 67, 18, 112, 97, 54, 117, 86, 51, 100, 70, 35, 33, 8, 24, 67,
            86, 85, 16, 131, 64, 50, 117, 86, 68, 4, 48, 80, 17, 18, 48, 16, 36, 96, 20, 69, 114,
            120, 20, 65, 50, 64, 71, 115, 21, 64, 135, 72, 72, 81, 101, 0, 33, 130, 80, 83, 119,
            51, 119, 68, 4, 134, 4, 80, 65, 19, 69, 33, 118, 114, 80, 131, 19, 19, 53, 48, 34, 52,
            86, 113, 23, 84, 49, 51, 18, 116, 16, 35, 64, 96, 135, 84, 135, 34, 23, 72, 72, 3, 88,
            100, 98, 96, 120, 119, 135, 49, 116, 55, 71, 52, 32, 6, 83, 54, 35, 87, 35, 120, 36,
            114, 71, 103, 88, 69, 72, 48, 55, 69, 128, 65, 49, 66, 8, 88, 35, 3, 23, 5, 115, 70,
            40, 21, 136, 86, 83, 50, 103, 69, 102, 54, 36, 66, 55, 24, 21, 21, 56, 17, 18, 56, 99,
            22, 49, 132, 102, 104, 0, 103, 115, 102, 23, 67, 39, 133, 23, 103, 136, 3, 71, 7, 101,
            53, 85, 100, 33, 17, 3, 67, 20, 132, 56, 21, 39, 104, 131, 22, 118, 37, 3, 112, 49, 4,
            69, 132, 97, 98, 54, 102, 118, 113, 84, 133, 35, 68, 19, 5, 132, 49, 133, 117, 132, 80,
            112, 35, 38, 97, 21, 3, 102, 88, 3, 100, 81, 82, 81, 7, 132, 0, 19, 86, 242, 105, 98,
            187, 107, 41, 182, 234, 160, 194, 114, 31, 162, 8, 58, 33, 237, 228, 247, 8, 155, 228,
            195, 245, 83, 67, 149, 212, 164, 47, 131, 97, 139, 199, 60, 118, 223, 188, 246, 111,
            44, 159, 225, 236, 106, 182, 191, 193, 61, 4, 107, 17, 11, 105, 39, 157, 114, 237, 228,
            55, 243, 85, 53, 65, 46, 161, 172, 247, 64, 128, 239, 204, 222, 106, 189, 205, 194,
            248, 160, 57, 249, 221, 40, 89, 64, 149, 233, 148, 255, 132, 25, 45, 54, 124, 173, 68,
            69, 129, 242, 103, 198, 40, 111, 156, 92, 251, 225, 24, 25, 101, 30, 218, 201, 102,
            242, 62, 3, 93, 217, 126, 92, 134, 237, 64, 32, 155, 133, 110, 94, 15, 143, 106, 184,
            161, 166, 106, 23, 120, 181, 44, 137, 177, 112, 45, 111, 175, 50, 139, 103, 38, 158,
            219, 116, 226, 182, 114, 44, 76, 111, 254, 62, 135, 190, 8, 151, 229, 23, 58, 195, 204,
            36, 46, 100, 122, 158, 225, 100, 60, 194, 51, 73, 140, 202, 41, 117, 94, 250, 77, 178,
            41, 44, 227, 132, 147, 250, 89, 159, 182, 63, 139, 112, 60, 91, 227, 14, 64, 25, 147,
            100, 52, 84, 198, 48, 193, 6, 101, 96, 95, 221, 17, 13, 77, 114, 140, 215, 61, 113, 40,
            160, 192, 223, 46, 208, 226, 224, 226, 57, 184, 107, 116, 177, 112, 238, 78, 238, 20,
            251, 6, 32, 104, 132, 32, 128, 151, 230, 43, 225, 108, 15, 130, 161, 11, 165, 115, 215,
            206, 162, 252, 189, 210, 250, 251, 182, 86, 129, 232, 122, 153, 35, 219, 136, 31, 75,
            159, 238, 137, 214, 123, 68, 119, 176, 218, 105, 232, 5, 196, 226, 108, 202, 27, 187,
            170, 32, 28, 122, 203, 20, 91, 90, 143, 77, 142, 19, 112, 14, 79, 13, 192, 11, 48, 42,
            240, 23, 7, 251, 229, 125, 218, 30, 47, 213, 99, 195, 251, 249, 61, 205, 103, 112, 45,
            210, 122, 222, 134, 126, 192, 15, 128, 23, 77, 206, 228, 98, 165, 224, 179, 47, 154, 8,
            93, 204, 28, 203, 112, 205, 81, 71, 119, 197, 156, 68, 13, 154, 238, 18, 83, 61, 196,
            237, 182, 216, 51, 150, 209, 149, 210, 10, 179, 220, 14, 9, 79, 0, 180, 78, 19, 193,
            192, 221, 71, 50, 254, 68, 198, 134, 185, 26, 126, 10, 12, 229, 82, 77, 26, 133, 208,
            202, 114, 146, 66, 112, 216, 212, 122, 39, 131, 120, 12, 81, 228, 11, 42, 240, 194,
            128, 85, 6, 193, 46, 39, 37, 84, 59, 51, 145, 45, 114, 76, 90, 227, 9, 59, 87, 198, 97,
            244, 79, 230, 84, 109, 112, 216, 210, 151, 119, 236, 44, 28, 189, 31, 53, 221, 135,
            132, 17, 170, 9, 34, 97, 61, 240, 171, 236, 229, 242, 114, 129, 59, 42, 1, 54, 120,
            110, 105, 117, 86, 144, 4, 1, 82, 219, 248, 234, 143, 109, 43, 175, 21, 23, 163, 254,
            171, 3, 248, 104, 212, 98, 214, 23, 119, 90, 213, 163, 241, 143, 50, 195, 202, 163,
            253, 73, 67, 185, 101, 153, 99, 171, 137, 114, 139, 146, 160, 16, 136, 145, 196, 160,
            127, 215, 197, 197, 58, 68, 16, 140, 24, 196, 22, 71, 51, 49, 182, 111, 21, 31, 164,
            67, 14, 198, 23, 156, 244, 92, 196, 92, 55, 203, 51, 80, 93, 167, 122, 61, 6, 64, 49,
            40, 198, 58, 216, 230, 43, 213, 210, 186, 69, 127, 33, 192, 39, 82, 250, 68, 106, 171,
            55, 11, 109, 2, 190, 83, 0, 152, 250, 176, 65, 116, 191, 238, 104, 130, 37, 40, 43,
            240, 144, 19, 245, 24, 84, 20, 10, 56, 77, 61, 224, 171, 221, 36, 93, 202, 61, 187,
            240, 17, 40, 193, 82, 162, 174, 249, 66, 40, 108, 218, 204, 226, 150, 204, 253, 76,
            252, 197, 31, 156, 61, 56, 24, 198, 197, 216, 203, 219, 231, 55, 20, 96, 222, 34, 133,
            197, 59, 162, 195, 172, 114, 253, 9, 231, 230, 103, 58, 44, 181, 27, 212, 150, 126,
            163, 223, 194, 141, 114, 240, 76, 135, 117, 80, 84, 2, 58, 255, 234, 80, 205, 60, 148,
            82, 64, 149, 19, 38, 152, 6, 114, 124, 32, 28, 195, 122, 149, 223, 188, 211, 9, 45,
            196, 18, 117, 129, 111, 112, 217, 160, 117, 90, 196, 88, 96, 110, 149, 151, 230, 228,
            64, 103, 86, 127, 236, 26, 22, 253, 133, 131, 188, 121, 130, 184, 39, 170, 81, 158,
            208, 46, 26, 139, 179, 54, 197, 55, 195, 159, 138, 76, 95, 236, 155, 20, 181, 49, 119,
            9, 62, 160, 222, 90, 2, 213, 46, 55, 42, 227, 33, 153, 217, 46, 181, 166, 23, 41, 111,
            80, 228, 54, 203, 112, 62, 197, 253, 2, 106, 70, 223, 133, 46, 164, 49, 6, 245, 148,
            167, 21, 253, 215, 158, 184, 61, 1, 246, 176, 40, 235, 99, 148, 68, 149, 61, 139, 176,
            200, 183, 193, 158, 159, 185, 36, 251, 46, 153, 61, 125, 197, 225, 206, 63, 121, 117,
            24, 227, 172, 119, 233, 108, 148, 54, 211, 207, 241, 173, 215, 83, 32, 210, 8, 213,
            176, 2, 82, 3, 248, 181, 110, 75, 194, 50, 62, 253, 40, 221, 211, 147, 131, 236, 113,
            93, 214, 69, 68, 190, 66, 217, 59, 0, 202, 116, 45, 206, 83, 233, 107, 16, 197, 33, 46,
            233, 31, 230, 61, 46, 239, 126, 30, 245, 231, 82, 170, 183, 189, 167, 33, 71, 232, 42,
            175, 168, 141, 252, 239, 254, 224, 154, 23, 190, 112, 166, 224, 146, 98, 105, 93, 219,
            114, 142, 190, 245, 184, 12, 85, 126, 148, 207, 172, 86, 103, 0, 73, 191, 217, 17, 116,
            34, 151, 201, 43, 27, 22, 149, 188, 216, 57, 53, 218, 181, 24, 28, 175, 97, 38, 47,
            210, 189, 59, 220, 180, 4, 255, 251, 239, 216, 217, 119, 116, 169, 178, 99, 77, 128,
            185, 205, 110, 80, 93, 53, 220, 216, 129, 3, 207, 86, 55, 79, 100, 234, 34, 23, 199,
            117, 225, 108, 58, 200, 188, 109, 184, 13, 66, 51, 233, 161, 206, 166, 56, 46, 168,
            126, 151, 55, 178, 126, 142, 104, 102, 210, 42, 6, 207, 190, 242, 108, 246, 186, 180,
            111, 79, 11, 227, 36, 114, 86, 162, 156, 160, 51, 221, 154, 193, 113, 71, 246, 236,
            187, 213, 205, 165, 187, 71, 102, 202, 181, 175, 37, 242, 49, 121, 58, 251, 19, 130,
            243, 39, 208, 130, 162, 145, 181, 2, 0, 244, 134, 43, 19, 96, 240, 182, 8, 111, 204,
            101, 231, 77, 100, 109, 218, 199, 165, 144, 202, 137, 175, 212, 73, 125, 189, 74, 118,
            43, 250, 109, 139, 107, 33, 71, 240, 146, 83, 189, 64, 208, 69, 171, 156, 9, 86, 169,
            189, 95, 246, 213, 155, 129, 198, 242, 235, 208, 88, 146, 94, 189, 25, 143, 156, 24,
            139, 107, 217, 37, 226, 45, 24, 237, 181, 55, 194, 13, 177, 60, 209, 119, 222, 75, 42,
            109, 84, 159, 169, 153, 138, 179, 171, 32, 47, 59, 170, 230, 20, 83, 215, 80, 230, 34,
            116, 22, 26, 90, 182, 28, 78, 10, 72, 247, 106, 68, 186, 150, 90, 163, 129, 49, 213,
            235, 128, 202, 14, 35, 111, 166, 140, 169, 254, 21, 111, 216, 170, 236, 173, 38, 184,
            54, 94, 98, 237, 154, 15, 46, 238, 95, 255, 71, 239, 222, 109, 244, 189, 127, 76, 232,
            249, 181, 175, 50, 100, 151, 6, 98, 251, 46, 118, 24, 101, 12, 21, 117, 117, 179, 57,
            122, 230, 185, 231, 149, 9, 237, 76, 156, 47, 6, 129, 107, 95, 213, 64, 143, 8, 147,
            104, 12, 49, 110, 227, 46, 198, 168, 56, 133, 43, 217, 172, 197, 70, 112, 36, 192, 22,
            155, 46, 147, 187, 71, 123, 72, 253, 240, 231, 21, 238, 118, 101, 77, 227, 152, 211,
            126, 93, 249, 34, 149, 81, 249, 180, 235, 24, 115, 235, 154, 209, 241, 120, 38, 147, 6,
            157, 119, 217, 50, 231, 22, 196, 142, 157, 74, 179, 5, 220, 209, 165, 223, 216, 214,
            195, 241, 0, 43, 81, 39, 192, 153, 127, 190, 72, 241, 216, 39, 130, 179, 227, 68, 17,
            204, 142, 192, 180, 88, 182, 5, 171, 149, 25, 87, 0, 2, 117, 215, 157, 42, 146, 226,
            69, 6, 227, 176, 169, 162, 18, 23, 152, 3, 147, 240, 174, 17, 120, 48, 193, 169, 90,
            13, 183, 187, 131, 189, 223, 229, 71, 78, 210, 114, 196, 224, 174, 237, 204, 199, 82,
            71, 206, 162, 177, 203, 214, 94, 31, 174, 114, 104, 167, 133, 83, 237, 122, 155, 57,
            22, 67, 225, 27, 252, 98, 239, 253, 210, 40, 167, 145, 16, 109, 153, 206, 6, 11, 123,
            176, 48, 131, 179, 2, 55, 44, 44, 136, 134, 140, 153, 115, 2, 92, 28, 208, 200, 168,
            246, 82, 43, 214, 239, 225, 237, 117, 202, 170, 79, 210, 142, 120, 73, 72, 4, 210, 129,
            167, 9, 217, 96, 108, 150, 131, 109, 194, 220, 28, 238, 121, 248, 163, 221, 188, 180,
            158, 12, 5, 20, 153, 166, 152, 182, 17, 184, 159, 0, 144, 159, 238, 149, 166, 101, 63,
            75, 170, 117, 235, 130, 59, 128, 10, 84, 125, 8, 196, 231, 42, 249, 94, 1, 130, 112,
            127, 12, 126, 214, 35, 218, 128, 122, 78, 219, 210, 62, 45, 165, 40, 90, 232, 14, 141,
            73, 179, 109, 117, 200, 205, 40, 227, 63, 135, 57, 46, 168, 71, 92, 147, 65, 15, 20,
            196, 194, 124, 71, 121, 130, 150, 28, 203, 34, 192, 214, 99, 91, 104, 116, 233, 238,
            48, 38, 215, 178, 236, 164, 111, 123, 161, 82, 124, 226, 61, 162, 167, 215, 27, 207,
            122, 37, 5, 147, 174, 41, 2, 124, 172, 38, 124, 69, 178, 54, 252, 50, 90, 209, 31, 132,
            28, 12, 102, 248, 218, 8, 205, 141, 175, 91, 7, 168, 186, 101, 27, 96, 88, 213, 23, 23,
            130, 120, 29, 158, 114, 46, 90, 233, 81, 102, 213, 227, 31, 198, 146, 236, 192, 142,
            150, 27, 42, 251, 163, 150, 161, 11, 228, 199, 8, 47, 241, 87, 41, 59, 142, 36, 28, 46,
            84, 194, 215, 76, 97, 204, 74, 28, 60, 237, 87, 126, 199, 206, 209, 101, 169, 107, 225,
            114, 216, 40, 159, 161, 126, 213, 63, 119, 108, 218, 103, 206, 128, 143, 68, 149, 37,
            179, 233, 61, 145, 157, 176, 93, 253, 122, 159, 165, 238, 178, 68, 165, 91, 43, 179,
            59, 156, 53, 232, 230, 23, 144, 149, 248, 52, 204, 66, 2, 61, 244, 199, 132, 169, 65,
            178, 228, 21, 146, 174, 255, 100, 64, 145, 32, 25, 243, 11, 69, 20, 208, 159, 34, 255,
            47, 121, 146, 188, 24, 18, 86, 64, 8, 117, 91, 118, 204, 210, 153, 136, 20, 212, 0,
            196, 9, 19, 75, 198, 171, 200, 57, 41, 93, 122, 163, 88, 253, 122, 165, 160, 133, 9,
            143, 36, 183, 176, 35, 198, 198, 166, 42, 88, 19, 85, 59, 51, 150, 184, 29, 165, 53,
            120, 86, 53, 32, 21, 2, 71, 254, 1, 155, 168, 30, 214, 102, 182, 104, 136, 234, 164, 6,
            84, 98, 150, 60, 108, 33, 63, 63, 227, 237, 123, 133, 25, 89, 114, 104, 173, 208, 64,
            169, 132, 60, 44, 111, 211, 63, 198, 244, 158, 255, 167, 189, 194, 42, 249, 247, 190,
            132, 208, 223, 167, 46, 46, 255, 240, 56, 106, 162, 168, 231, 59, 162, 174, 97, 62, 56,
            42, 126, 187, 224, 227, 104, 254, 186, 137, 207, 75, 207, 108, 205, 40, 45, 68, 10,
            157, 204, 3, 108, 155, 198, 253, 109, 138, 36, 227, 218, 39, 243, 50, 150, 120, 73,
            160, 192, 111, 32, 67, 251, 41, 64, 64, 174, 227, 215, 3, 84, 87, 96, 128, 75, 125, 60,
            175, 135, 15, 149, 56, 237, 34, 13, 210, 52, 199, 12, 205, 165, 85, 136, 123, 66, 196,
            195, 150, 211, 224, 142, 142, 73, 99, 237, 20, 178, 227, 101, 125, 187, 216, 131, 99,
            195, 192, 184, 153, 58, 172, 51, 85, 36, 156, 82, 38, 119, 162, 247, 78, 97, 208, 35,
            177, 176, 190, 229, 13, 165, 56, 187, 246, 253, 137, 73, 181, 234, 174, 48, 246, 178,
            151, 54, 105, 223, 57, 141, 195, 111, 228, 204, 139, 95, 158, 98, 5, 173, 207, 238, 59,
            89, 246, 18, 205, 70, 158, 199, 185, 145, 112, 66, 169, 96, 145, 206, 158, 160, 110,
            166, 124, 108, 199, 178, 165, 94, 157, 242, 3, 79, 91, 35, 154, 153, 174, 53, 168, 101,
            57, 3, 43, 99, 196, 87, 133, 23, 232, 3, 115, 224, 193, 66, 162, 246, 142, 163, 203,
            118, 44, 218, 42, 207, 7, 217, 141, 74, 99, 212, 161, 228, 204, 7, 45, 128, 80, 87, 52,
            122, 243, 208, 77, 19, 13, 121, 45, 9, 109, 197, 106, 109, 42, 131, 212, 150, 107, 81,
            248, 93, 160, 216, 113, 198, 8, 208, 213, 12, 102, 29, 40, 125, 33, 13, 128, 114, 52,
            136, 249, 89, 51, 185, 227, 136, 221, 24, 61, 217, 26, 99, 119, 88, 27, 237, 40, 84,
            149, 29, 58, 251, 246, 248, 17, 8, 24, 143, 14, 52, 192, 112, 52, 122, 43, 223, 47,
            179, 212, 23, 239, 157, 30, 176, 88, 31, 209, 50, 94, 29, 230, 197, 81, 39, 115, 157,
            185, 22, 229, 240, 147, 235, 8, 220, 103, 220, 83, 203, 160, 247, 144, 52, 248, 181,
            245, 207, 185, 158, 3, 241, 114, 31, 251, 81, 159, 163, 129, 253, 61, 31, 199, 145, 25,
            200, 169, 6, 10, 247, 81, 59, 57, 234, 129, 197, 18, 200, 242, 173, 72, 186, 141, 97,
            15, 103, 206, 77, 105, 169, 123, 172, 55, 143, 201, 73, 212, 166, 69, 187, 56, 110,
            141, 172, 122, 36, 76, 89, 163, 221, 59, 188, 235, 106, 109, 60, 235, 151, 156, 34,
            253, 170, 108, 229, 58, 212, 153, 216, 252, 140, 246, 64, 74, 115, 76, 40, 75, 88, 211,
            68, 15, 20, 145, 82, 208, 114, 140, 129, 135, 227, 4, 75, 243, 241, 102, 14, 28, 159,
            62, 188, 39, 24, 223, 76, 163, 111, 219, 49, 129, 119, 202, 172, 48, 122, 220, 128,
            197, 106, 37, 88, 178, 19, 32, 103, 202, 176, 73, 136, 204, 88, 230, 134, 242, 96, 94,
            77, 87, 51, 106, 205, 32, 45, 88, 219, 99, 5, 35, 41, 14, 154, 90, 107, 124, 244, 246,
            89, 99, 215, 212, 72, 166, 226, 90, 227, 64, 122, 100, 194, 180, 113, 193
        ],
        generated_key.private.expose_secret()
    );
}

#[tokio::test]
async fn test_parse_jwk_invalid_alg() {
    // given
    let ml_dsa = MlDsa;

    let private_jwk = PrivateKeyJwk::Mlwe(PrivateKeyJwkMlweData {
        r#use: None,
        kid: None,
        alg: "P-512".to_string(),
        x: "invalid".to_string(),
        d: "invalid".into(),
    });

    // when
    let result = ml_dsa.parse_private_jwk(private_jwk);

    // then
    assert!(
        matches!(result, Err(KeyAlgorithmError::Failed(msg)) if msg == "unsupported alg P-512")
    );
}
